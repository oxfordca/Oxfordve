<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <data> 
  <record id="paperformat_forma_libre" model="report.paperformat">

      <field name="header_line" eval="False"/>
            <field name="name">A4 Factura Forma Libre igtf</field>
            <field name="default" eval="True"/>
            <field name="format">custom</field>
            <field name="page_height">300</field>
            <field name="page_width">240</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">40</field>
            <field name="margin_bottom">90</field>
            <field name="margin_left">0</field>
            <field name="margin_right">0</field>
            <field name="header_spacing">0</field>
            <field name="dpi">96</field>
    </record>

    <template id="report_invoice_with_payments_copy">
            <t t-call="web.html_container">
              <t t-call="web.basic_layout" >
                <div class="page"> <!-- 1 -->
                  
                  <div class="container"> <!-- 2 -->
                    <div class="row">

                      <!--formato factura  -->
                      <t t-if="docs.move_type== 'out_invoice' ">
                      <div class="col-12">
                        <ul class="list-inline mb4" style="font-size:14px;">
                          <li t-if="docs.invoice_date"><strong>Fecha de Emisión:</strong>
                              <span t-field="docs.invoice_date"/>
                          </li>
                          <li t-if="docs.invoice_number_next"><strong>Factura:</strong>
                              <span t-field="docs.invoice_number_next"/>
                          </li>
                          <li t-if="docs.partner_id.name">
                              <strong>Razón Social:</strong> <span t-field="docs.partner_id.name"/>
                          </li>
                          <li t-if="docs.partner_id.street or docs.partner_id.street2">
                              <strong>Dirección:</strong> <span t-field="docs.partner_id.street"/>,
                                            <span t-field="docs.partner_id.street2"/>
                          </li>
                          <li t-if="docs.partner_id.vat">
                              <strong>RIF:</strong> <span t-field="docs.partner_id.doc_type"/>-<span t-field="docs.partner_id.vat"/>
                          </li>

                        </ul>
                      </div>
                    </t>

                   <!--Formato de Nota de credito -->
                   <t t-elif="docs.move_type== 'out_refund' ">
                     <div class="col-12">
                       
                        <tr  width="15">
                       <td colspan="4" align="right" style="font-size:14px" ><t t-esc="docs.invoice_number_next"/></td>
                       </tr>
                        <ul class="list-inline mb4" style="font-size:14px;">
                          <li t-if="docs.invoice_date"><strong>Fecha de Emisión:</strong>
                              <span t-field="docs.invoice_date"/>
                          </li>
                          <li t-if="docs.invoice_number_next"><strong>Factura Afectada:</strong>
                              <span t-field="docs.reason"/>
                          </li>
                          <li t-if="docs.partner_id.name">
                              <strong>Razón Social:</strong> <span t-field="docs.partner_id.name"/>
                          </li>
                          <li t-if="docs.partner_id.street or docs.partner_id.street2">
                              <strong>Dirección:</strong> <span t-field="docs.partner_id.street"/>,
                                            <span t-field="docs.partner_id.street2"/>
                          </li>
                          <li t-if="docs.partner_id.vat">
                              <strong>RIF:</strong> <span t-field="docs.partner_id.doc_type"/>-<span t-field="docs.partner_id.vat"/>
                          </li>

                        </ul>
                      </div>

                   </t>

                  <!--formato nota de debito  -->
                   <t t-elif="docs.move_type== 'out_receipt' ">

                   <div class="col-12">
                       
                        <tr  width="15">
                       <td colspan="4" align="right" style="font-size:14px" ><t t-esc="docs.invoice_number_next"/></td>
                       </tr>
                        <ul class="list-inline mb4" style="font-size:12px;">
                          <li t-if="docs.invoice_date"><strong>Fecha de Emisión:</strong>
                              <span t-field="docs.invoice_date"/>
                          </li>
                          <li t-if="docs.invoice_number_next"><strong>Factura Afectada:</strong>
                              <span t-field="docs.reason"/>
                          </li>
                          <li t-if="docs.partner_id.name">
                              <strong>Razón Social:</strong> <span t-field="docs.partner_id.name"/>
                          </li>
                          <li t-if="docs.partner_id.street or docs.partner_id.street2">
                              <strong>Dirección:</strong> <span t-field="docs.partner_id.street"/>,
                                            <span t-field="docs.partner_id.street2"/>
                          </li>
                          <li t-if="docs.partner_id.vat">
                              <strong>RIF:</strong> <span t-field="docs.partner_id.doc_type"/>-<span t-field="docs.partner_id.vat"/>
                          </li>

                        </ul>
                      </div>
                   </t>

                    </div>

                    <t t-set="acum_alicuota_general" t-value="0"/>
                     <table class="table table-borderless table-sm" style="margin-top:14px;">
                      <thead class="bordeAbajo bordeArriba">
                        <tr style="font-size:12px;">
                            <td>CANTIDAD</td>
                            <td >DESCRIPCIÓN</td>
                            <td align="right">PRECIO UNITARIO Bs</td>
                            <td align="right">MONTO TOTAL Bs</td>
                        </tr>
                      </thead>
                      <tbody>
                          <t t-foreach="docs.invoice_line_ids" t-as="line">
                              <tr  style="font-size:14px;">
                                <td t-esc="int(line.quantity)"/>
                                <td t-esc="line.product_id.name"/>
                                <td align="right" t-esc="(line.fact_div_line(line.price_unit))" t-options='{"widget": "float", "precision": 2}'/>
                                <td align="right" t-esc="(line.fact_div_line(line.price_subtotal))" t-options='{"widget": "float", "precision": 2}'/>
                              </tr>
                              <t t-if="line.tax_ids.aliquot == 'general'">
                                <t t-set="acum_alicuota_general" t-value="acum_alicuota_general + line.price_subtotal"/>
                              </t>
                          </t>
                      </tbody>
                     </table>


              </div> 

                            <t t-set="acum_subtotal_retention" t-value="0"/>
                             <t t-set="acum_retention_iva" t-value="0"/>
                             <t t-set="acum_retention_islr" t-value="0"/>
                             <t t-set="acum_subtotal_usd" t-value="0"/>

            <div class="footer">                  
            <div class="container">
                             
      
                      <div class="clearfix" style="margin-top:20px;" height="100%">
                        <div class="row">
                            <div class="col-2"/>
                            <div class="col-7 text-left">
                              <ul class="list-inline mb4" style="font-size:14px;"  height="100%">
                                             <li>
                                                <strong>TASA DE CAMBIO OFICIAL US$/Bs:</strong>
                                                <span t-field="docs.os_currency_rate"  t-options='{"widget": "float", "precision": 4}'/>
                                            </li>
                                            <li>
                                                <strong>EXENTO US$:</strong>
                                                <span t-esc="docs.fact_div_usd(docs.exemto_eq)" t-options='{"widget": "float", "precision": 2}'/>

                                                <t t-set="acum_subtotal_usd" t-value="acum_subtotal_usd+(docs.exemto_eq)"/>
                                            </li>
                                             <li>
                                                <strong>BASE IMPONIBLE US$:</strong>
                                                <span t-esc="docs.fact_div_usd(docs.base_imponible_eq)"  t-options='{"widget": "float", "precision": 2}'/>

                                                <t t-set="acum_subtotal_usd" t-value="acum_subtotal_usd+(docs.base_imponible_eq)"/>
                                            </li>
                                             <li>
                                                <strong>IVA 16% US$:</strong>
                                                <span t-esc="docs.fact_div_usd(docs.total_impuesto_eq)" t-options='{"widget": "float", "precision": 2}'/>

                                                 <t t-set="acum_subtotal_usd" t-value="acum_subtotal_usd+(docs.total_impuesto_eq)"/>

                                            </li>
                                             <li>
                                                <strong>TOTAL US$:</strong>
                                                <span t-esc="docs.fact_div_usd(acum_subtotal_usd)" t-options='{"widget": "float", "precision": 2}'/>
                                            </li>
                                            
                                           <li>
                                              <strong >RET I.V.A US$:</strong>
                                                
                                                <!--span t-field="docs.retention_iva_id.amount_total_retention_usd" t-options='{"widget": "float", "precision": 2}'/-->

                                                <span t-esc="docs.valida_iva(docs.retention_iva_id)" t-options='{"widget": "float", "precision": 2}'/>
                                                

                                                <t t-set="acum_subtotal_retention" t-value="acum_subtotal_retention+(docs.retention_iva_id.amount_total_retention_usd)"/>

                                            </li> 
                  
                                              <li>
                                        
                                                <strong>RET I.S.L.R US$:</strong>

                                                <span t-esc="docs.valida_islr(docs.retention_id)" t-options='{"widget": "float", "precision": 2}'/>

                                                <!--span t-esc="docs.retention_id.amount_total_retention_usd" t-options='{"widget": "float", "precision": 2}'/-->

                                                 <t t-set="acum_subtotal_retention" t-value="acum_subtotal_retention+(docs.retention_id.amount_total_retention_usd)"/>
                                            </li>

                                             <li>
                                                <strong> IGTF US$:</strong>
                                                <span t-esc="docs.fact_div_usd(docs.impuesto_igtf_eq)" t-options='{"widget": "float", "precision": 2}'/>

                                                <t t-set="acum_subtotal_usd" t-value="acum_subtotal_usd+(docs.impuesto_igtf_eq)"/>

                                            </li>

                                            
                                             <li>
                                                <strong>TOTAL A PAGAR US$:</strong>
                                                <span  t-esc="docs.fact_div_usd(acum_subtotal_usd) - acum_subtotal_retention " t-options='{"widget": "float", "precision": 2}'/>
                                            </li>
                                            
                              </ul>
                            </div>
                        </div>
                      </div>


                  </div> <!-- fin 2 -->
                  
                    <div class="container"  style="margin-top:20px; page-break-inside: avoid;">
                            <div class="bordeAbajo bordeArriba">
                                <div class="row">
                                    <div class="col-2"/>
                                    <div class="col-5 text-left">
                                        <ul class="list-inline mb4" style="font-size:13px;">
                                            <li><strong>MONTO TOTAL DEL EXENTO O EXONERADO:</strong></li>
                                            <li><strong>MONTO DE LA BASE IMPONIBLE 16%:</strong></li>
                                            <li><strong>MONTO TOTAL DEL IMPUESTO AL VALOR AGREGADO 16%:</strong></li>
                                            <li><strong>MONTO TOTAL DE LA VENTA:</strong></li>
                                        </ul>
                                    </div>
                                    <div class="col-5 text-right">
                                        <ul class="list-inline mb4" style="font-size:13px;">
                                            <li> <span t-esc="(docs.fact_div(docs.exemto_org))" t-options='{"widget": "float", "precision": 2}'/></li>
                                            <li> <span t-esc="(docs.fact_div(acum_alicuota_general))" t-options='{"widget": "float", "precision": 2}'/></li>
                                        <!--    <li> <span t-esc="docs.base_imponible_org" t-options='{"widget": "float", "precision": 2}'/></li> -->
                                           <li> <span t-esc="(docs.fact_div(docs.total_impuesto_org))" t-options='{"widget": "float", "precision": 2}'/></li> 
                                            <li> <span t-esc="(docs.fact_div(docs.sub_total_org))" t-options='{"widget": "float", "precision": 2}'/></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <t t-set="espacio" t-value="0"/>
                            <t t-set="acum_ret_igtf" t-value="0"/>

                             <div class="bordeAbajo bordeArriba"><!-- arriba -->
                            <div class="col-2"/>
                                <div class="col-7 text-right">    
                              <ul class="list-inline mb4" style="font-size:14px;">
                                <li><strong>FORMA DE PAGO Y RECEPCION IGTF:</strong></li>
                              </ul>
                            </div>
                          
                              

                                <div class="col-14 text-right">
                                  <t t-foreach="docs.formas_pago" t-as="metodo"> 
                                    <div style="font-size:14px;">
                                      <span t-esc="metodo.name"/>&amp;nbsp;&amp;nbsp;
                                      (BCV:<span t-esc="docs.bcv(metodo.id)" t-options='{"widget": "float", "precision": 4}'/>)&amp;nbsp;&amp;nbsp; <span t-esc="docs.monto_base(metodo.id)" t-options='{"widget": "float", "precision": 2}'/>&amp;nbsp;&amp;nbsp;  IGTF 3% &amp;nbsp;&amp;nbsp;
                                      <span t-esc="docs.monto_ret(metodo.id)" t-options='{"widget": "float", "precision": 2}'/>
                                      <t t-set="acum_ret_igtf" t-value="acum_ret_igtf+docs.monto_ret(metodo.id)"/>

                                    </div>
                                  </t>
                                        
                                    

                                <div style="font-size:12px;">TOTAL NETO A COBRAR : &amp;nbsp;&amp;nbsp;<t t-esc="(acum_ret_igtf)+(docs.fact_div(docs.sub_total_org))" t-options='{"widget": "float", "precision": 2}'/> 

                                </div>    

                                </div> 
                             </div> <!-- fin arriba -->
                             </div>
                      </div>

                </div> <!-- fin 1 -->
              </t>
            </t>
    </template>

   

    <report
            id="account_facturas"
            model="account.move"
            string="Factura/NC/ND"
            report_type="qweb-pdf"
            name="l10n_ve_igtf_formato_libre.report_invoice_with_payments_copy"
            file="l10n_ve_igtf_formato_libre.report_invoice_with_payments_copy"
            paperformat="l10n_ve_igtf_formato_libre.paperformat_forma_libre"
        />

        
  
  </data>
</odoo>